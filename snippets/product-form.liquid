 {%- liquid
  assign check_against_inventory = true
  if product.selected_or_first_available_variant.inventory_management != 'shopify' or product.selected_or_first_available_variant.inventory_policy == 'continue'
    assign check_against_inventory = false
  endif
  if product.selected_or_first_available_variant.quantity_rule.min > product.selected_or_first_available_variant.inventory_quantity and check_against_inventory
    assign quantity_rule_soldout = true
  endif
  -%}
<div x-data="productForm('{{ product.handle }}', {{ product.selected_or_first_available_variant.id }})" class="flex flex-col">
  {%- form 'product', product, id: product_form_id, class: 'form flex flex-col gap-6', novalidate: 'novalidate', data-type: 'add-to-cart-form' -%}
    <input type="hidden" name="id" x-model="selectedVariant" value="{{ product.selected_or_first_available_variant.id }}" {% if product.selected_or_first_available_variant.available == false or quantity_rule_soldout or product.selected_or_first_available_variant == nil %} disabled {% endif %} class="product-variant-id">
    <input type="hidden" name="quantity" x-model="quantity" class="product-quantity">
    {% render 'product-variant-picker', product: product, block: block, product_form_id: product_form_id %}
    <div class="flex gap-2">
        <div class="quantity flex w-fit border border-gray-200 rounded-sm max-w-[132px]" data-url="{{ product.url }}" data-section="{{ section.id }}">
          <button class="quantity__button py-5 px-4 flex items-center justify-center transition hover:bg-gray-100" name="minus" type="button" @click="quantity++">
            {% render 'icon', icon: 'minus', class: '!h-2.5 !w-2.5' %}
          </button>
          <input
          class="quantity text-base text-center font-semibold w-full"
          type="number"
          name="quantity"
          id="Quantity-{{ section.id }}"
          data-cart-quantity="{{ cart_qty }}"
          data-min="{{ product.selected_or_first_available_variant.quantity_rule.min }}"
          min="{{ product.selected_or_first_available_variant.quantity_rule.min }}"
          {% if product.selected_or_first_available_variant.quantity_rule.max != null %}
          data-max="{{ product.selected_or_first_available_variant.quantity_rule.max }}"
          max="{{ product.selected_or_first_available_variant.quantity_rule.max }}"
          {% endif %}
          step="{{ product.selected_or_first_available_variant.quantity_rule.increment }}"
          value="{{ product.selected_or_first_available_variant.quantity_rule.min }}"
          form="{{ product_form_id }}"
          >
          <button class="quantity__button py-5 px-4 flex items-center justify-center transition hover:bg-gray-100" name="plus" type="button">
            {% render 'icon', icon: 'plus', class: '!h-2.5 !w-2.5' %}
          </button>
            </div>
          <button
            id="ProductSubmitButton"
            type="submit"
            name="add"
            class="button w-full uppercase"
            {% if product.selected_or_first_available_variant.available == false
              or quantity_rule_soldout
              or product.selected_or_first_available_variant == nil
            %}
              disabled
            {% endif %}
          >
            <span>
              {%- if product.selected_or_first_available_variant == nil -%}
                {{ 'products.product.unavailable' | t }}
              {%- elsif product.selected_or_first_available_variant.available == false or quantity_rule_soldout -%}
                {{ 'products.product.sold_out' | t }}
              {%- else -%}
                {{ 'products.product.add_to_cart' | t }}
              {%- endif -%}
            </span>
          </button>
            </div>
          {%- if show_dynamic_checkout -%}
            {{ form | payment_button }}
          {%- endif -%}
  {%- endform -%}
</div>



