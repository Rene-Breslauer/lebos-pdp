function d(t){let s=()=>{let r,l;try{l=localStorage}catch(a){console.error(a),console.warn("Alpine: $persist is using temporary storage since localStorage is unavailable.");let e=new Map;l={getItem:e.get.bind(e),setItem:e.set.bind(e)}}return t.interceptor((a,e,i,o,p)=>{let n=r||`_x_${o}`,u=g(n,l)?f(n,l):a;return i(u),t.effect(()=>{let c=e();m(n,c,l),i(c)}),u},a=>{a.as=e=>(r=e,a),a.using=e=>(l=e,a)})};Object.defineProperty(t,"$persist",{get:()=>s()}),t.magic("persist",s),t.persist=(r,{get:l,set:a},e=localStorage)=>{let i=g(r,e)?f(r,e):l();a(i),t.effect(()=>{let o=l();m(r,o,e),a(o)})}}function g(t,s){return s.getItem(t)!==null}function f(t,s){let r=s.getItem(t,s);if(r!==void 0)return JSON.parse(r)}function m(t,s,r){r.setItem(t,JSON.stringify(s))}var v=d;export{v as default,d as persist};
